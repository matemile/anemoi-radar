(.venv) matem@c6525-1l5jvp3-bn-compute:~/mlpp_tutorial$ anemoi-datasets create radar_simple.yaml /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr
2026-02-05 12:35:32 INFO ðŸŽ¬ Task init((),{}) starting
2026-02-05 12:35:33 INFO Setting flatten_grid=True in config
2026-02-05 12:35:33 INFO Setting ensemble_dimension=2 in config
2026-02-05 12:35:33 INFO Setting flatten_grid=True in config
2026-02-05 12:35:33 INFO Setting ensemble_dimension=2 in config
2026-02-05 12:35:33 INFO {'start': datetime.datetime(2020, 11, 13, 10, 0, tzinfo=datetime.timezone.utc), 'end': datetime.datetime(2020, 11, 13, 20, 0, tzinfo=datetime.timezone.utc), 'frequency': '15m', 'missing': [datetime.datetime(2020, 11, 13, 13, 15)], 'group_by': 'daily'}
2026-02-05 12:35:33 INFO Groups(dates=1,StartEndDates(2020-11-13 10:00:00..2020-11-13 20:00:00 every 0:15:00))
2026-02-05 12:35:33 INFO Groups: Groups(dates=1,StartEndDates(2020-11-13 10:00:00..2020-11-13 20:00:00 every 0:15:00))
2026-02-05 12:35:33 INFO Minimal input for 'init' step (using only the first date) : GroupOfDates(dates=['2020-11-13T10:00:00'])
2026-02-05 12:35:33 INFO JoinResult: 1 dates (2020-11-13T10:00)
  netcdf(GroupOfDates(dates=['2020-11-13T10:00:00']))
2026-02-05 12:35:33 INFO Config loaded ok:
2026-02-05 12:35:33 INFO Found 41 datetimes.
2026-02-05 12:35:33 INFO Dates: Found 41 datetimes, in 1 groups: 
2026-02-05 12:35:33 INFO Missing dates: 1
dates ['2020-11-13T10:00:00'] {'param': ['lwe_precipitation_rate', 'is_nodata', 'is_blocked', 'block_percent']}
2026-02-05 12:35:34 INFO Found 4 variables : block_percent,is_blocked,is_nodata,lwe_precipitation_rate.
2026-02-05 12:35:34 INFO Found 1 ensembles : -.
2026-02-05 12:35:34 INFO gridpoints size: [3614996, 3614996]
2026-02-05 12:35:34 INFO resolution=None
2026-02-05 12:35:34 INFO total_shape = [41, 4, 1, 3614996]
2026-02-05 12:35:34 INFO chunks=(1, 4, 1, 3614996)
2026-02-05 12:35:34 INFO Creating Dataset '/lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr', with total_shape=[41, 4, 1, 3614996], chunks=(1, 4, 1, 3614996) and dtype='float32'
2026-02-05 12:35:34 WARNING Dataset name error: the dataset name 'radar-nordic-1day-15m-v1' does not follow naming convention. Does not match ^(\w+)-([\w-]+)-(\w+)-(\w+)-(\d\d\d\d)-(\d\d\d\d)-(\d+h|\d+m)-v(\d+)-?([a-zA-Z0-9-]+)?$
2026-02-05 12:35:35 INFO Number of years 0 < 10, leaving out 20%. end=numpy.datetime64('2020-11-13T17:45:00')
2026-02-05 12:35:35 INFO Will compute statistics from 2020-11-13T10:00:00 to 2020-11-13T17:45:00
2026-02-05 12:35:35 INFO ðŸ Task init((),{}) completed (0:00:02.200460)
2026-02-05 12:35:35 INFO ðŸŽ¬ Task load((),{}) starting
2026-02-05 12:35:35 INFO {'end': '2020-11-13T20:00:00+00:00', 'frequency': '15m', 'group_by': 'daily', 'missing': ['2020-11-13T13:15:00'], 'start': '2020-11-13T10:00:00+00:00'}
2026-02-05 12:35:35 INFO Groups(dates=1,StartEndDates(2020-11-13 10:00:00..2020-11-13 20:00:00 every 0:15:00))
2026-02-05 12:35:35 WARNING Dataset /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr has missing dates
dates ['2020-11-13T10:00:00', '2020-11-13T10:15:00', '2020-11-13T10:30:00', '2020-11-13T10:45:00', '2020-11-13T11:00:00', '2020-11-13T11:15:00', '2020-11-13T11:30:00', '2020-11-13T11:45:00', '2020-11-13T12:00:00', '2020-11-13T12:15:00', '2020-11-13T12:30:00', '2020-11-13T12:45:00', '2020-11-13T13:00:00', '2020-11-13T13:30:00', '2020-11-13T13:45:00', '2020-11-13T14:00:00', '2020-11-13T14:15:00', '2020-11-13T14:30:00', '2020-11-13T14:45:00', '2020-11-13T15:00:00', '2020-11-13T15:15:00', '2020-11-13T15:30:00', '2020-11-13T15:45:00', '2020-11-13T16:00:00', '2020-11-13T16:15:00', '2020-11-13T16:30:00', '2020-11-13T16:45:00', '2020-11-13T17:00:00', '2020-11-13T17:15:00', '2020-11-13T17:30:00', '2020-11-13T17:45:00', '2020-11-13T18:00:00', '2020-11-13T18:15:00', '2020-11-13T18:30:00', '2020-11-13T18:45:00', '2020-11-13T19:00:00', '2020-11-13T19:15:00', '2020-11-13T19:30:00', '2020-11-13T19:45:00', '2020-11-13T20:00:00'] {'param': ['lwe_precipitation_rate', 'is_nodata', 'is_blocked', 'block_percent']}
2026-02-05 12:35:36 INFO Loading array shape=(40, 4, 1, 3614996), indexes=40
Loading 159/160: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 160/160 [00:05<00:00, 28.29it/s]
2026-02-05 12:35:41 INFO Computing statistics for (40, 4, 1, 3614996) array
Computing statistics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:04<00:00,  8.54it/s]
2026-02-05 12:35:46 INFO Statistics computed for 4 variables.
2026-02-05 12:35:46 INFO Flush data array
2026-02-05 12:35:47 INFO Flushed data array
/home/matem/.venv/lib/python3.10/site-packages/anemoi/utils/provenance.py:143: UserWarning: The '__version__' attribute is deprecated and will be removed in MarkupSafe 3.1. Use feature detection, or `importlib.metadata.version("markupsafe")`, instead.
  versions[name] = str(module.__version__)
2026-02-05 12:35:48 INFO Name               : /data
Type               : zarr.core.Array
Data type          : float32
Shape              : (41, 4, 1, 3614996)
Chunk shape        : (1, 4, 1, 3614996)
Order              : C
Read-only          : True
Compressor         : Blosc(cname='lz4', clevel=5, shuffle=SHUFFLE, blocksize=0)
Store type         : zarr.storage.DirectoryStore
No. bytes          : 2371437376 (2.2G)
No. bytes stored   : 91482066 (87.2M)
Storage ratio      : 25.9
Chunks initialized : 40/41

2026-02-05 12:35:48 INFO ðŸ Task load((),{}) completed (0:00:13.013529)
2026-02-05 12:35:48 INFO ðŸŽ¬ Task finalise((),{}) starting
2026-02-05 12:35:48 WARNING Dataset /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr has missing dates
2026-02-05 12:35:48 INFO Variables minimum maximum mean stdev has_nans
block_percent 0.00 100.00 3.20 11.23 1.00
is_blocked 0.00 1.00 0.26 0.44 1.00
is_nodata 0.00 1.00 0.48 0.50 1.00
lwe_precipitation_rate 0.00 95.54 0.03 0.32 1.00
2026-02-05 12:35:48 INFO Wrote statistics in /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr
Computing size of /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr: 0it [00:00, ?itComputing size of /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr: 16it [00:00, 491.07it/s]
2026-02-05 12:35:48 INFO Total size: 99.6 MiB
2026-02-05 12:35:48 INFO Total number of files: 146
2026-02-05 12:35:48 WARNING Dataset /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr has missing dates
2026-02-05 12:35:48 INFO ðŸ Task finalise((),{}) completed (0:00:00.401250)
2026-02-05 12:35:48 INFO ðŸŽ¬ Task init_additions((),{}) starting
2026-02-05 12:35:48 WARNING No delta found in kwargs, no additions will be computed.
2026-02-05 12:35:48 INFO ðŸ Task init_additions((),{}) completed (0:00:00.000142)
2026-02-05 12:35:48 INFO ðŸŽ¬ Task run_additions((),{}) starting
2026-02-05 12:35:48 WARNING No delta found in kwargs, no additions will be computed.
2026-02-05 12:35:48 INFO ðŸ Task run_additions((),{}) completed (0:00:00.000094)
2026-02-05 12:35:48 INFO ðŸŽ¬ Task finalise_additions((),{}) starting
2026-02-05 12:35:48 WARNING No delta found in kwargs, no additions will be computed.
Computing size of /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr: 0it [00:00, ?itComputing size of /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr: 16it [00:00, 1892.26it/s]
2026-02-05 12:35:48 INFO Total size: 99.6 MiB
2026-02-05 12:35:48 INFO Total number of files: 146
2026-02-05 12:35:48 WARNING Dataset /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr has missing dates
2026-02-05 12:35:48 INFO ðŸ Task finalise_additions((),{}) completed (0:00:00.148698)
2026-02-05 12:35:48 INFO ðŸŽ¬ Task patch((),{}) starting
2026-02-05 12:35:48 INFO âœ… Remove _create_yaml_config
2026-02-05 12:35:48 INFO Dataset changed by patch
2026-02-05 12:35:48 INFO ðŸ Task patch((),{}) completed (0:00:00.280341)
2026-02-05 12:35:48 INFO ðŸŽ¬ Task cleanup((),{}) starting
2026-02-05 12:35:48 INFO ðŸ Task cleanup((),{}) completed (0:00:00.001548)
2026-02-05 12:35:48 INFO ðŸŽ¬ Task verify((),{}) starting
2026-02-05 12:35:48 INFO Verifying dataset at /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr
2026-02-05 12:35:49 WARNING Dataset /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr has missing dates
2026-02-05 12:35:49 INFO /lustre/storeB/users/matem/data/zarr/radar-nordic-1day-15m-v1.zarr
2026-02-05 12:35:49 INFO ðŸ Task verify((),{}) completed (0:00:00.003245)
2026-02-05 12:35:49 INFO Create completed in 16 seconds
